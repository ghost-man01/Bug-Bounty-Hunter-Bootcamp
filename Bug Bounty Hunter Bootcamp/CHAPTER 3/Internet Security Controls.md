# Content Encoding
* Always try to *Decode* the the encoded form, if there is anything. https://www.urlencoder.org/ or CyberChef



# Session Management and Cookies

* Session management allows user to login again without credentials.
* When we login, A new SESSION starts.
	* Server create *SESSION ID* for your browser that serves a proof of Identity.
	* When you logged out ends the SESSION and revokes the *SESSION ID*
	* ![[Pasted image 20220330014537.png]]

## Cookie Session
* Cookies are just small piece of data that web-servers send to your browser, when you login to a site server creates a *SESSION ID* for your browser
* Browser stores *SESSION ID* and then include in all the request you sent to server to validate that it's you.
* When you logged out server invalidate the *Cookie* so that it can't be used again
*  ![[Pasted image 20220330020506.png]]

# Token Based Authentication
* In token based authentication, it doesn't stores your information like SESSION BASED authentication. It stores this info in some sort of token.
* Tokens deduce you identity by decoding the token itself.

## Risk
If there is information used in token it can be changed and user can be logged in as another user if it's updated.

#### Prevent

Application generally used Encryption or Encoding so that user can't understand <br>
But it can't make it totally safe for *Token Forgery Attacks*.

### Signature 

* Often applications uses signature and verifying it when arrives at server.
* Signature is generated if only if you know secret key, it is generated by server only.

### Working of Signature 


User -> login -> server generate signature -> Every request + signature -> validated -> Retrieving Data.

# JSON WEB TOKENS (JWT)

* JSON web tokens usually used for authentication.
* It has three Components 
	* A Header
	* A Payload
	* A Signature

## Header
* *Header* identifies the algorithm to generate signature.
* It's a Base64url-encoded string containing the algorithm name.
* It's always starts with **ey**

## Payload
* This section contains the information of User's identity.
* This section is also base64url encoded 

## Signature

* Signature validates that user hasn't tampered with the token.
	* It's calculated by concatenating header with the payload, then signing it with algorithm specified in the header and a secret key.

 The complete token is concatenates each token: *Header, Payload and Signature* and separated by the (.) period.

If JSON implemented correctly json authenticate nicely, but if there is something incorrect attacker can bypass it.

## Manipulating *alg*  field

* An attacker can forge their token is by tampering with *alg* field of the token header.
	* Which lists the algorithm used to encode signature.

- If application doesn't restrict the algorithm type and used in the JWT, an attacker can compromise by specifying which algorithm is to be used.
- JWT tokens supports a "none" options.
	- If alg field is set to "none" tokens with empty signature section considered valid.

 - If it's not turned off in a production environment, it would allow any attacker to forge any token they want and impersonate anyone on the site.

* Another way attacker can exploit alg field is by changing the type of *algorithm* used.
	* for sign two most common algorithms used for JWT's are HMAC and RSA.
	* HMAC requires the token to be signed with a key and then later verified with the same key
	* RSA, the token would be first created with a private key, then verified with the corresponding public key.


## Brute Forcing the Key

If the key is not complex, might be an attacker can guess it or brute force it.<br>
If an attacker brute force the key they might try leaking the secret key instead. <br>
If there is another vulnerability like directory traversal, external entity attack, or SSRF exists that allow the attacker to read the file where the key value is stored and an attacker steal the key and sign arbitrary token of their chosen.

## Reading Sensitive Information

- Since JWT tokens are used since they often contains user's information.
- If token is not encrypted anyone decode it and read token's payload.
- If token contains sensitive info it might be the source of info leaks.
- Properly implemented signature section of JSON web token provides data integrity, not confidentiality. 
	- ![[Pasted image 20220331140804.png]]


# Same Origin Policy (SOP)

Same Origin Policy is said to be a website those two pages having same hostname and port number.

Let's take an example :

https://twitter.com/ghost_man01
https://twitter.com/
http://twitter.com/ghost_man01
https://twitter.com:8080/ghost_man01
https://instagram.com/ghost__man01

* Only 1 and 2 having Same Origin Policy because of same hostname and same port number.



![[Recording 20220331183058.webm]]


